---
import { Image } from 'astro:assets';

import { getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const work = await getCollection("work");
  return work.map((item) => ({
    params: { id: item.slug },
    props: item
  }));
}

const { data } = Astro.props;
const { 
  title, 
  img,
  galleryImg1,
  galleryImg2,
  galleryImg3,
  galleryImg4,
} = data;
const slug = Astro.props.slug;

const { Content } = await render(Astro.props)

export const prerender = true;
---

<Layout title={`${title} - Portfolio`}>
  <div class="flex flex-col gap-10 mt-3">
    <section class="flex flex-col gap-10">
      <Image
        transition:name={`image-${slug}`}
        src={`/media/work/${slug}/${img}`}
        alt={`Cover of ${title}`} 
        class="w-full object-cover rounded-2xl bg-[#f2f2f2]"
        width="1280" 
        height="960"
        decoding="async"
        loading="lazy"
      />
      <div class="flex md:flex-row flex-col gap-5 md:gap-10">
        <h1 class="text-xl sm:text-2xl md:text-3xl md:w-1/5 font-semibold">{title}</h1>
        <div class="md:w-3/5 md:text-xl">
          <Content />
        </div>
      </div>
      <Image
        src={`/media/work/${slug}/${galleryImg1}`}
        alt={`${title} First gallery image`} 
        class="w-full object-cover rounded-2xl bg-[#f2f2f2]"
        width="1280" 
        height="960"
        decoding="async"
        loading="lazy"
      />
      {galleryImg2 && (
        <Image
          src={`/media/work/${slug}/${galleryImg2}`}
          alt={`${title} Second gallery image`} 
          class="w-full object-cover rounded-2xl bg-[#f2f2f2]"
          width="1280" 
          height="960"
          decoding="async"
          loading="lazy"
        />
      )}
      {galleryImg3 && (
        <Image
          src={`/media/work/${slug}/${galleryImg3}`}
          alt={`${title} Second gallery image`} 
          class="w-full object-cover rounded-2xl bg-[#f2f2f2]"
          width="1280" 
          height="960"
          decoding="async"
          loading="lazy"
        />
      )}
      {galleryImg4 && (
        <Image
          src={`/media/work/${slug}/${galleryImg4}`}
          alt={`${title} Second gallery image`} 
          class="w-full object-cover rounded-2xl bg-[#f2f2f2]"
          width="1280" 
          height="960"
          decoding="async"
          loading="lazy"
        />
      )}
    </section>
  </div>
</Layout>